{
  "template_registry": {
    "registry_version": "1.1.0",
    "scope": "math_1_4",
    "source": {
      "generated_by": "chatgpt",
      "generated_at": "2026-02-09",
      "notes": "New missing templates batch (T4,T11,T12,T13,T14) built to match existing TemplateRegistry format."
    },
    "enums": {
      "task_type_enum": [
        "number_sense",
        "numeral_systems",
        "arithmetic_fluency",
        "fractions_percent",
        "word_problems",
        "measurement_units",
        "geometry",
        "data_representation",
        "patterns_logic"
      ],
      "format_enum": [
        "plain_text",
        "inline_examples",
        "column",
        "fill_gaps",
        "table",
        "diagram",
        "number_line",
        "grid",
        "drawing",
        "mixed"
      ],
      "constraints_enum": [
        "needs_visual",
        "has_table",
        "has_diagram",
        "has_number_line",
        "has_grid",
        "has_drawing",
        "multi_step",
        "unit_conversion",
        "roman_numerals",
        "fraction_notation",
        "percent",
        "trick_question"
      ],
      "template_params_keys": [
        "ops",
        "range_max",
        "written_algorithm",
        "unknown_component",
        "compare_mode",
        "change_mode",
        "word_model",
        "unit_kind",
        "data_task_mode",
        "geometry_mode",
        "logic_mode"
      ]
    },
    "templates": [
      {
        "template_code": "T4",
        "template_id": "T4_pedagogical_template",
        "title": "Устное сложение и вычитание (до 100)",
        "grade_min": 1,
        "grade_max": 4,
        "formats_allowed": [
          "plain_text",
          "inline_examples",
          "fill_gaps",
          "mixed"
        ],
        "ped_keys_defaults": {
          "task_type": "arithmetic_fluency",
          "format": "inline_examples",
          "topic": "mental_add_sub_to_100",
          "constraints": [],
          "template_params_defaults": {
            "ops": [
              "add",
              "sub"
            ],
            "range_max": 100,
            "written_algorithm": false
          }
        },
        "routing": {
          "match_keys": {
            "task_type": "arithmetic_fluency",
            "topic": "mental_add_sub_to_100",
            "formats_allowed": [
              "plain_text",
              "inline_examples",
              "fill_gaps",
              "mixed"
            ]
          },
          "routing_rules": [
            {
              "rule_id": "T4_MENTAL_ADD_SUB_ANCHOR",
              "routing_priority": 85,
              "must_have": {
                "text_patterns_any": [
                  "(устно|в уме|в уме вычисли|считай устно)",
                  "(переход(ом)? через десяток|через десяток)",
                  "(разложи(те)? число|по разрядам)"
                ],
                "text_patterns_all": [],
                "visual_kinds_any": []
              },
              "must_not": {
                "text_patterns_any": [
                  "столбик|в столбик|столбиком|письменно",
                  "__GAP__",
                  "=|уравнен|неизвестн|x|икс",
                  "умнож|делен|:|÷|×|\\*",
                  "остаток|чётн|нечётн",
                  "римск|[IVXLCDM]{1,}"
                ],
                "visual_kinds_any": [
                  "column",
                  "table",
                  "diagram",
                  "number_line"
                ]
              }
            },
            {
              "rule_id": "T4_INLINE_ADD_SUB_EXAMPLES_NO_COLUMN",
              "routing_priority": 70,
              "must_have": {
                "text_patterns_any": [
                  "(вычисли(те)?|реши(те)?|найди(те)? значение)(.*)?(\\+|−|-)",
                  "\\b\\d{1,2}\\s*(\\+|−|-)\\s*\\d{1,2}\\b"
                ],
                "text_patterns_all": [],
                "visual_kinds_any": []
              },
              "must_not": {
                "text_patterns_any": [
                  "столбик|в столбик|столбиком|письменно",
                  "__GAP__",
                  "=|уравнен|неизвестн|x|икс",
                  "умнож|делен|:|÷|×|\\*",
                  "в\\s+\\d+\\s+раз(а)?",
                  "периметр|площадь|см²|м²"
                ],
                "visual_kinds_any": [
                  "column",
                  "table",
                  "diagram"
                ]
              }
            }
          ],
          "confusables": [
            "T5",
            "T6",
            "T3",
            "T15",
            "T35"
          ]
        },
        "hint_policy_defaults": {
          "default_visible": 1,
          "max_hints": 2
        },
        "notes_for_backend": []
      }
    ],
    "routing_tests": [
      {
        "id": "RT_T04_A",
        "kind": "positive",
        "description": "Вычисли устно: 47 + 28.",
        "expected": {
          "template_id": "T4_pedagogical_template",
          "task_type": "arithmetic_fluency",
          "format": "inline_examples",
          "topic": "mental_add_sub_to_100"
        },
        "why": "Сложение двух двузначных чисел, устные приёмы."
      },
      {
        "id": "RT_T04_B",
        "kind": "positive",
        "description": "Считай в уме: 60 − 27.",
        "expected": {
          "template_id": "T4_pedagogical_template",
          "task_type": "arithmetic_fluency",
          "format": "plain_text",
          "topic": "mental_add_sub_to_100"
        },
        "why": "Устное вычитание с переходом через десяток."
      },
      {
        "id": "RT_T04_C",
        "kind": "negative",
        "description": "Выполни сложение столбиком: 47 + 28.",
        "expected": {
          "not_template_id": "T4_pedagogical_template"
        },
        "why": "Есть явный маркер «столбиком» — это T5."
      }
    ]
  },
  "template_profiles": {
    "T4_pedagogical_template": {
      "hint_style_profile": {
        "tone": "friendly_teacher",
        "do_not_repeat_task_text": true,
        "line_break_each_step": true
      },
      "max_hints_default": 2,
      "age_language": {
        "grade_min": 1,
        "grade_max": 4,
        "register": "kid_friendly_ru"
      },
      "teaching_pattern": {
        "goal": "Научить быстро и уверенно складывать и вычитать устно, используя разложение на десятки и единицы и переход через десяток.",
        "l1": {
          "format": "Идея приёма",
          "rules": [
            "Определи, что удобнее: разложить число на десятки и единицы или «дойти» до круглого десятка.",
            "Если есть переход через десяток — сначала доведи до ближайшего десятка, потом добавь/убери остаток."
          ],
          "forbidden": [
            "давать конечный ответ сразу",
            "переписывать условие задачи целиком"
          ]
        },
        "l2": {
          "format": "Ключевой шаг",
          "rules": [
            "Покажи разложение: (40+7)+(20+8) → (40+20)+(7+8) или похожий удобный путь.",
            "Следи за переходом через 10: 7+8 = 15 — это +10 и ещё +5."
          ],
          "forbidden": [
            "давать полный ответ без шагов"
          ]
        },
        "l3": {
          "format": "Проверка",
          "rules": [
            "Сделай быструю проверку обратным действием (если вычитали — сложи обратно).",
            "Если много примеров — совет: сначала считай десятки, потом единицы, затем собери."
          ],
          "forbidden": [
            "решить за ребёнка полностью",
            "раскрывать все вычисления до конца без запроса"
          ]
        }
      },
      "common_mistakes": [
        "При переходе через десяток забывают добавить/вычесть «перенос» (7+8=15, но записывают 5, забывая +10).",
        "Путают разряды: складывают десятки с единицами (40+7 считают как 47+0).",
        "При вычитании с переходом неправильно «занимают» из десятков (60−27: берут 10, но забывают уменьшить 60 до 50).",
        "Разлагают число неудобно: 47+28 как (47+20)+8 вместо более удобного (47+3)+25.",
        "Считают слева направо без учёта удобных комбинаций (не замечают, что 7+3=10)."
      ],
      "terminology_rules": {
        "use_terms": [],
        "avoid_terms": [
          "очевидно",
          "элементарно"
        ]
      },
      "disclosure_defaults": {
        "show_checks": false
      }
    }
  }
}